<!DOCTYPE html5>
<html>
<head>
<meta charset="UTF-8" />
<style>
body {
	background: #eeeef0;
	color: #666;
	font-family: Arial, Helvetica, Liberation Sans, sans-serif;
	font-size: .8em;
	height: 1000px;
}
ul {
	list-style-type: none;
	margin-left: -2em;
}
li:before {
	content: "‒ ";
}
.circle {
	display: inline-block;
	opacity: .4;
	border-radius: 5px;
}
.blue {
	width: 10px;
	height: 10px;
	background: #003;
}
.red, .green {
	width: 8px;
	height: 8px;
}
.red {
	background: #300;
}
.green {
	background: #030;
}
a {
	color: inherit;
}
.by, .bookmarklet {
	text-decoration: none;
	font-weight: bold;
}
.bookmarklet {
	font-size: 1.5em;
	background: #333;
	color: #eeeef0;
	padding: .3em .5em;
	border-radius: .1em;
}
</style>
</head>
<body>

<h1>Touch Bookmarklet</h1>

<p>Simulate touch events with a mouse, for fun or debugging.</p>

<h2>Preparing your browser:</h2>

<ul>
	<li><b>Firefox</b>: Install the <a href="https://addons.mozilla.org/en-US/firefox/addon/touch-enabler/">Touch Enabler</a> addon and restart Firefox.</li>
	<!--<li><b>Chrome</b>: Start your browser from the command line with the touch switch:
		<ul>
			<li>Ubuntu: <code>/opt/google/chrome/google-chrome --enable-touch-events</code></li>
			<li>MacOS: <code>/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --enable-touch-events</code></li>
			<li>Windows: <code>chrome.exe --enable-touch-events</code></li>
		</ul>
	</li>-->
	<li><b>Chrome</b>: <i>Currently being worked on</i></li>
</ul>

<h2>Usage:</h2>

<ul>
	<li>Add/Remove hovering fingers ( <span class="circle blue"></span> ): <kbd><kbd>Shift</kbd>+<kbd>Click</kbd></kbd></li>
	<li>Drag a particular <span class="circle blue"></span> to simulate swiping with a single finger</li>
	<li>Activate Swipe ( <span class="circle red"></span> ) and Rotate/Pinch ( <span class="circle green"></span> ) handles: <kbd>↓<kbd>Ctrl</kbd></kbd></li>
	<li>Drag <span class="circle red"></span> to simulate swiping with all fingers</li>
	<li>Drag <span class="circle green"></span> to simulate rotate/pinch with all fingers</li>
</ul>

<!--<h3>Limitations</h3>

<p>
	While using Swipe and Rotate/Pinch handles, the<br/>
	<code>target</code> attribute of the touch events isn't updated.
</p>-->

<br/>

<a class="bookmarklet" href='javascript:(function(t,f,h,n){function u(){this.list={}}function v(a,b){var e=d.cloneNode();this.centerX=a.pageX;this.centerY=a.pageY;e.style.left=this.centerX-11+"px";e.style.top=this.centerY-11+"px";e.style.pointerEvents="none";e.className="tchPoint";this.id=e.id=b;this[0]=f.body.appendChild(e)}function w(a){var b=d.cloneNode(),e=d.cloneNode();b.style.background="#300";e.style.background="#030";b.style.width=b.style.height=e.style.width=e.style.height="16px";e.className=b.className="tchHandle";b.id="tchSwipe"; e.id="tchPR";this[0]=f.body.appendChild(b);this[1]=f.body.appendChild(e);this.move(a);this.off()}for(var k=f.createElement("div").style,o=["O","ms","Webkit","Moz",""],p=o.length,m,q,r,c,g,l,i,d;p--;)if(q=o[p]+(o[p]?"Transform":"transform"),q in k){k=q;m=k.replace(/form/,"ition");break}d=f.createElement("div");d.style.position="absolute";d.style.display="block";d.style.visibility="visible";d.style.zIndex=999;d.style.margin=d.style.padding=0;d.style.width=d.style.height="20px";d.style.borderRadius= "10px";d.style.boxShadow="1px 1px 3px #333";d.style.background="#003";d.style.opacity=0.3;k={click:function(a){var b;a.shiftKey&&(c.length()&&(b=c.get(a.pageX,a.pageY))?c.remove(b.id):c.add(a))},mousedown:function(a){var b,e=a.target.className;!a.shiftKey&&!a.ctrlKey&&(b=c.get(a.pageX,a.pageY))?(g=b.down(),g.cidTouch("touchstart",a),c.handles&&c.handles.hide(),a.preventDefault()):a.ctrlKey&&"tchHandle"==e&&(i="tchSwipe"==a.target.id?[a.pageX,a.pageY]:[0,1],l=a.target.id,c.down(),c.cidTouchs("touchstart", a),a.preventDefault())},mouseup:function(a){g?(g.up(),g.cidTouch("touchend",a),g=n,c.handles&&(c.handles.move(c.center()),c.handles.show())):l&&(c.up(),c.cidTouchs("touchend",a),a.ctrlKey||c.handles.off(),l=n,c.handles.move(c.handles.centerX,c.handles.centerY));a.preventDefault()},mousemove:function(a){var b,e,s;g?(g.move(a.pageX,a.pageY),g.cidTouch("touchmove",a),a.preventDefault()):l&&("tchSwipe"==l?(b=a.pageX-i[0],e=a.pageY-i[1],c.moveBy(b,e),c.handles.move(a.pageX,a.pageY),i=[a.pageX,a.pageY]): (c.handles.moveRP(a.pageX,a.pageY),b=a.pageX-c.handles.centerX,e=a.pageY-c.handles.centerY,s=h.sqrt(b*b+e*e)/100,b=-h.atan2(b,e)+h.PI/2,c.rp(b-i[0],(s-i[1])/i[1]),i=[b,s]),c.cidTouchs("touchmove",a))},keydown:function(a){if(17==a.keyCode&&c.handles)c.handles.on()},keyup:function(a){17==a.keyCode&&c.handles&&!l&&c.handles.off()},selectstart:function(a){a.preventDefault()}};u.prototype={add:function(a){var b="tch"+h.round(1E6*h.random());this.list[b]=new v(a,b);a=this.length();2==a&&(this.handles=new w(this.center())); 2<a&&this.handles.move(this.center())},remove:function(a){a=this.get(a);a.remove();delete this.list[a.id];a=this.length();1==a&&(this.handles.remove(),this.handles=n);1<a&&this.handles.move(this.center())},get:function(a,b){if(b)for(var e=Object.keys(this.list),c=e.length,j;c--;){if(j=this.list[e[c]],a<j.centerX+11&&a>j.centerX-11&&b<j.centerY+11&&b>j.centerY-11)return j}else return this.list[a.target&&a.target.id||a]},length:function(){return Object.keys(this.list).length},center:function(){var a= 1E5,b=0,e=1E5,c=0,j,d;for(j in this.list)d=this.list[j],d.centerX>b&&(b=d.centerX),d.centerX<e&&(e=d.centerX),d.centerY>c&&(c=d.centerY),d.centerY<a&&(a=d.centerY);return[e+(b-e)/2,a+(c-a)/2]},down:function(){for(var a in this.list)this.list[a].down()},up:function(){for(var a in this.list)this.list[a].up()},moveBy:function(a,b){var e,c;for(e in this.list)c=this.list[e],c.move(c.centerX+a,c.centerY+b)},rp:function(a,b){var e,c,d,f,g;for(e in this.list)c=this.list[e],d=c.centerX-this.handles.centerX, f=c.centerY-this.handles.centerY,g=-h.atan2(d,f)+h.PI/2+a,d=h.sqrt(d*d+f*f),d+=d*b,c.move(h.cos(g)*d+this.handles.centerX,h.sin(g)*d+this.handles.centerY)},createTouchList:function(a,b){var e=[],c,d=0;for(c in this.list)e.push(this.list[c].createTouch(a,b,d++));return f.createTouchList(e)},cidTouchs:function(a,b){var c=this.createTouchList(a,b),d;for(d in this.list)this.list[d].cidTouch(a,b,c)}};v.prototype={remove:function(){f.body.removeChild(this[0])},down:function(){this[0].style.left=this.centerX- 10+"px";this[0].style.top=this.centerY-10+"px";this[0].style.boxShadow="none";this[0].style.opacity=0.5;this[0].style.zIndex=1E3;return this},up:function(){this[0].style.left=this.centerX-11+"px";this[0].style.top=this.centerY-11+"px";this[0].style.boxShadow="1px 1px 3px #300";this[0].style.opacity=0.3;this[0].style.zIndex=999},move:function(a,b){this.centerX=a;this.centerY=b;this[0].style.left=a-10+"px";this[0].style.top=b-10+"px"},createTouch:function(a,b,c){"touchstart"==a&&(this.target=f.elementFromPoint(this.centerX- scrollX,this.centerY-scrollY));return f.createTouch(t,this.target,c||0,this.centerX,this.centerY,this.centerX+b.screenX-b.pageX,this.centerY+b.screenY-b.pageY,this.centerX+b.clientX-b.pageX,this.centerY+b.clientY-b.pageY)},createTouchList:function(a,b){return f.createTouchList([this.createTouch(a,b)])},cidTouch:function(a,b,c){c||(c=this.createTouchList(a,b));for(var d=[],g=f.createEvent("touchevent"),h=c.length,i=-1;++i<h;)c.item(i).target==this[0]&&d.push(c.item(i));d=f.createTouchList(d);g.initTouchEvent(a, !0,!0,t,0,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,c,d,c);this.target.dispatchEvent(g);"touchend"==a&&(this.target=n)}};w.prototype={remove:function(){f.body.removeChild(this[0]);f.body.removeChild(this[1])},hide:function(){this[0].style.display=this[1].style.display="none"},show:function(){this[0].style.display=this[1].style.display="block"},move:function(a,b){a.length&&(b=a[1],a=a[0]);this.centerX=a;this.centerY=b;this[0].style.left=this.centerX-11+"px";this[0].style.top=this.centerY-11+"px";this[1].style.left= this.centerX+89+"px";this[1].style.top=this.centerY-11+"px"},moveRP:function(a,b){this[1].style.left=a-11+"px";this[1].style.top=b-11+"px"},on:function(){this[0].style.zIndex=this[1].style.zIndex=1E3;this[0].style.opacity=this[1].style.opacity=0.5;this[0].style[m]=this[1].style[m]="none"},off:function(){this[0].style.zIndex=this[1].style.zIndex=998;this[0].style.opacity=this[1].style.opacity=0.15;this[0].style[m]=this[1].style[m]="top .8s, left .8s"}};c=new u;for(r in k)f.addEventListener(r,k[r], !1)})(window,document,Math);'>Touch Bookmarklet</a>

<br/><br/><br/>

by <a href="http://twitter.com/louis_remi">@louis_remi</a>

<script src="../touch.bookmarklet.js"></script>
</body>
</html>